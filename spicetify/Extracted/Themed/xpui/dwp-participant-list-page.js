"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[987],{80918:(e,s,n)=>{n.d(s,{X:()=>v});var t=n(30758),i=n(62411),r=n(49263),o=n(93492),a=n(12032),l=n(56695),c=n(71338),u=n(56116),d=n(48975),m=n(24395),p=n(21053),b=n(49593),g=n(68055),x=n(80687),f=n(86070);const k=({currentUserUri:e,uri:s,name:n,divider:m,onBlock:k})=>{const v=(0,u.W)(),h=!(0,d.n)(),{isBlocked:w,blockUser:C,unblockUser:j}=function(e,s,n,r){const[l,u]=(0,t.useState)(!1),d=(0,i.wA)(),m=(0,p.a)(),f=(0,x.A)(),{enqueueSnackbar:k}=(0,c.d)();return(0,t.useEffect)((()=>{e&&(0,g.zP)(f,{currentUserUri:e,uri:s}).then((e=>{if(m()){if(200!==e.status)throw new Error("Invalid response from socialgraph");u(e.body?.[0]?.is_dismissed||!1)}}))}),[e,s,m,f]),{isBlocked:l,blockUser:()=>{e&&d((0,a.zj)(s,n,r))},unblockUser:async()=>{e&&(await(0,g.kV)(b.n.getInstance(),{currentUserUri:e,uri:s}),k(o.Ru.get("feedback.unblock-user")))}}}(e,s,n,k),R=(0,t.useCallback)((async()=>{v({targetUri:s,intent:w?"unblock":"block",type:"click"}),w?await j():await C()}),[v,s,C,j,w]);if(!e||e===s)return null;const y=w?o.Ru.get("contextmenu.unblock"):o.Ru.get("contextmenu.block");return(0,f.jsx)(l.D,{role:"menuitem",divider:m,disabled:h,onClick:R,leadingIcon:(0,f.jsx)(r.r,{semanticColor:"textSubdued",size:"small"}),children:y})},v=t.memo((function(e){return(0,f.jsx)(m.pZ,{value:"block-user",children:(0,f.jsx)(k,{...e})})}))},34855:(e,s,n)=>{n.d(s,{B:()=>A});var t=n(30758),i=n(62411),r=n(93492),o=n(55669),a=n(80918),l=n(42026),c=n(33650),u=n(56695),d=n(24395),m=n(86070);const p=t.memo((function({onClick:e,divider:s,canEdit:n}){return e&&n?(0,m.jsx)(d.pZ,{value:"edit-profile",children:(0,m.jsx)(u.D,{role:"menuitem",divider:s,onClick:e,leadingIcon:(0,m.jsx)(c.G,{semanticColor:"textSubdued",size:"small"}),children:r.Ru.get("contextmenu.edit-profile")})}):null}));var b=n(27508),g=n(96869),x=n(8950),f=n(56116),k=n(48975),v=n(306),h=n(98962),w=n(82362);const C=()=>{},j=({uri:e,divider:s,onRemoveCallback:n=C})=>{const{spec:o,logger:a}=(0,w.r)(x.F,{data:{uri:e}}),l=(0,f.W)(),c=!(0,k.n)(),d=(0,i.d4)(h.Ht).user,[p,j]=(0,v.Y)(e),R=(0,t.useCallback)((()=>{const s=o.followButtonFactory();l({targetUri:e,intent:p?"unfollow":"follow",type:"click"}),p?(j(!1),a.logInteraction(s.hitUnfollow({itemToBeUnfollowed:e})),n(e)):(j(!0),a.logInteraction(s.hitFollow({itemToBeFollowed:e})))}),[p,a,l,n,j,o,e]);if(d&&d.uri===e)return null;const y=p?r.Ru.get("contextmenu.unfollow"):r.Ru.get("contextmenu.follow");return(0,m.jsx)(u.D,{role:"menuitem",testid:"follow-user-context-menu-item",divider:s,disabled:c,onClick:R,leadingIcon:p?(0,m.jsx)(b.M,{semanticColor:"textBrightAccent",size:"small"}):(0,m.jsx)(g.h,{semanticColor:"textSubdued",size:"small"}),children:y})},R=t.memo((function(e){return(0,m.jsx)(d.pZ,{value:"follow-user",children:(0,m.jsx)(j,{...e})})}));var y=n(97395),U=n(5879),I=n(12032),S=n(90843),B=n(94822),N=n(75788),E=n(33887);function M({userUri:e}){const{currentSession:s}=(0,B.D)(),n=(0,N.d)(),o=(0,i.wA)(),a=(0,t.useCallback)((()=>{const n=(0,E.Bj)(s?.sessionMembers??[],e);n&&o((0,I.A9)(S.EL.REMOVE_PARTICIPANT,void 0,n))}),[s?.sessionMembers,o,e]),l=(0,E.kt)(n,e);return s?.active&&e&&l?(0,m.jsx)(u.D,{role:"menuitem",onClick:a,leadingIcon:(0,m.jsx)(U.f,{semanticColor:"textSubdued",size:"small"}),children:r.Ru.get("web-player.social-connect.kick-users.remove-the-user")}):(0,m.jsx)(m.Fragment,{})}var F=n(68055),T=n(43080),O=n(69611);const A=t.memo((function({uri:e,onEditProfileCallback:s}){const{user:n}=(0,i.d4)(h.Ht),{spec:t}=(0,O.o)(e),{data:c,loading:u}=(0,T.Z)(F.E$,[{uri:e}]);return u?null:c?(0,m.jsx)(d.pZ,{value:"user",children:(0,m.jsxs)(o.W,{children:[(0,m.jsx)(R,{uri:e}),(0,m.jsx)(M,{userUri:e}),(0,m.jsx)(a.X,{uri:c.uri,name:c.name,currentUserUri:n?.uri}),(0,m.jsx)(p,{onClick:s,canEdit:!(e!==n?.uri||c.edit_image_disabled&&c.edit_name_disabled)}),(0,m.jsx)(y.P,{spec:t,uri:e,canReportUser:!c.report_abuse_disabled,currentUserUri:n?.uri}),(0,m.jsx)(l.m,{spec:t,uri:e,displayText:r.Ru.get("contextmenu.share.copy-profile-link")})]})}):null}))},66847:(e,s,n)=>{n.d(s,{ParticipantListPage:()=>N});var t=n(30758),i=n(62411),r=n(85387),o=n(13505),a=n(72574),l=n(93492),c=n(56330),u=n(64359),d=n(45192),m=n(14256),p=n(94822),b=n(86070);const g=({memberToBeRemoved:e,onClose:s})=>{const{logRemoveClick:n}=(0,m.R)(),{currentSession:i,removeSessionMember:r}=(0,p.D)(),o=e?.id??"",a=e?.displayName??"",c=i?.sessionId??"",u=(0,t.useCallback)((()=>{n(o,c),o&&(r(o),s())}),[n,o,c,r,s]),g=(0,t.useCallback)((()=>{s()}),[s]);return(0,b.jsx)(d.T,{isOpen:Boolean(o),titleText:l.Ru.get("web-player.social-connect.participant-list.remove-guest-dialog",{displayName:a}),"aria-label":l.Ru.get("web-player.social-connect.participant-list.remove-guest-dialog",{displayName:a}),confirmText:l.Ru.get("web-player.social-connect.participant-list.remove-guest"),cancelText:l.Ru.get("web-player.social-connect.participant-list.remove-guest-cancel"),onConfirm:u,onClose:g})};var x=n(21974),f=n(66987),k=n(43866),v=n(19837),h=n(12367),w=n(34855),C=n(5119),j=n(98178);const R="VaoPVkde4AzxorQnp6Jp",y="dDz8CzVKiV2128rhR543",U="tBAiRbWhD79Gi2XqZ_AG",I=({sessionMember:e,index:s,showRemoveButton:n,onClickRemove:t,onClickMember:i})=>{const{displayName:r,images:a,uri:c,username:u}=(0,j.c)(e);return(0,b.jsx)(h.h,{menu:(0,b.jsx)(w.B,{uri:c}),children:(0,b.jsx)("span",{children:(0,b.jsxs)(k.$,{rowIndex:s,className:R,children:[(0,b.jsx)(f.T,{columnIndex:0,children:(0,b.jsxs)(C.N,{to:c,className:U,onClick:i,"aria-label":r,children:[(0,b.jsx)(v.e,{images:a,userIconSize:"medium",width:32,displayName:r,username:u,label:r}),(0,b.jsx)(o.E,{as:"p",variant:"bodyMediumBold",semanticColor:"textBase",children:r})]})}),n&&(0,b.jsx)(f.T,{columnIndex:1,className:y,children:(0,b.jsx)(x.n,{size:"small",onClick:t,"aria-label":l.Ru.get("web-player.social-connect.participant-list.remove-guest-accessible-label",{displayName:r}),children:l.Ru.get("web-player.social-connect.participant-list.remove-guest")})})]})})})};var S=n(82272);const B="qAE8wMAxO5THZoNqlb0q",N=()=>{const e=(0,i.d4)((e=>e.session.user?.id)),{currentSession:s}=(0,p.D)(),[n,d]=(0,t.useState)(),{logUserClick:m,logRemoveClick:x,UBIFragmentWithSpec:f}=(0,S.T)(),k=(0,t.useCallback)(((e,s)=>{x(e),d(s)}),[x]),v=(0,t.useCallback)(((e,s)=>{const n=(0,a.Qjr)(s.username).toURI();m(e,n)}),[m]),h=(0,t.useCallback)((()=>{d(void 0)}),[]),w=s?.sessionMembers.find((e=>e.id===s.sessionOwnerId));if(!s||!w)return(0,b.jsx)(r.C5,{to:"/queue"});const C=s.isSessionOwner?2:1;return(0,b.jsxs)("section",{className:"contentSpacing",children:[(0,b.jsx)(u.Q,{children:l.Ru.get("web-player.social-connect.participant-list.title",{host:w.displayName})}),(0,b.jsx)(o.E,{as:"h1",variant:"titleSmall",semanticColor:"textBase",children:l.Ru.get("web-player.social-connect.participant-list.title")}),(0,b.jsx)(o.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textSubdued",children:l.Ru.get("web-player.social-connect.participant-list.subtitle")}),(0,b.jsx)(c.f,{"aria-colcount":C,"aria-rowcount":s.sessionMembers.length,"aria-label":l.Ru.get("web-player.social-connect.participant-list.title"),className:B,children:s.sessionMembers.map(((n,t)=>(0,b.jsx)(I,{sessionMember:n,showRemoveButton:s.isSessionOwner&&n.username!==e,index:t,onClickRemove:()=>k(t,n),onClickMember:()=>v(t,n)},n.displayName)))}),(0,b.jsx)(f,{children:(0,b.jsx)(g,{memberToBeRemoved:n,onClose:h})})]})}},82272:(e,s,n)=>{n.d(s,{T:()=>a});var t=n(30758),i=n(25366),r=n(82362),o=n(86070);const a=()=>{const{spec:e,logger:s,UBIFragment:n}=(0,r.r)(i.I,{});return{logUserClick:(0,t.useCallback)(((n,t)=>{s.logInteraction(e.participantListFactory().participantListRowFactory({position:n}).userLinkFactory().hitUiNavigate({destination:t}))}),[s,e]),logRemoveClick:(0,t.useCallback)((n=>{s.logInteraction(e.participantListFactory().participantListRowFactory({position:n}).removeButtonFactory().hitUiReveal())}),[s,e]),UBIFragmentWithSpec:(0,t.useCallback)((s=>(0,o.jsx)(n,{spec:e,...s})),[n,e])}}},306:(e,s,n)=>{n.d(s,{Y:()=>l});var t=n(30758),i=n(72574),r=n(12469),o=n(37395),a=n(9043);const l=e=>{const s=(0,o.f)(),[n,l]=(0,t.useState)(!1);if(!(0,i.APS)(e))throw new Error(`Expected a Spotify uri in format 'spotify:user:***', got "${e}"`);const c=(0,t.useCallback)((t=>t&&!n?s.followUsers([e]):!t&&n?s.unfollowUsers([e]):Promise.resolve()),[s,n,e]);return(0,t.useEffect)((()=>{l(!1),s.isFollowing([e]).then((s=>{l(s[e]??!1)}))}),[s,e]),(0,a.N)(r.mc.OPERATION_COMPLETE,(s=>{s.data.uris.includes(e)&&!s.data.error&&(s.data.operation===r.JK.FOLLOW_USER?l(!0):s.data.operation===r.JK.UNFOLLOW_USER&&l(!1))})),[n,c]}},98178:(e,s,n)=>{n.d(s,{c:()=>r,t:()=>o});var t=n(72574);const i=e=>({url:e}),r=e=>{const s=[];return e.largeImageUrl?s.push(i(e.largeImageUrl)):e.imageUrl&&s.push(i(e.imageUrl)),{displayName:e.displayName,images:s,username:e.username,uri:(0,t.Qjr)(e.username).toURI()}},o=(e,s,n)=>{const t=[],i=e.sessionMembers.find((({id:s})=>s===e.sessionOwnerId));i&&t.push(i);const o=e.isSessionOwner?void 0:e?.sessionMembers.find((({username:e})=>e===s));o&&(n?.userFirst?t.unshift(o):t.push(o));const a=e.sessionMembers.filter((({username:n,id:t})=>t!==e.sessionOwnerId&&n!==s));return[...t,...a].map(r)}},14256:(e,s,n)=>{n.d(s,{R:()=>o});var t=n(30758),i=n(45298),r=n(82362);const o=()=>{const{spec:e,logger:s}=(0,r.r)(i.T,{});return{logRemoveClick:(0,t.useCallback)(((n,t)=>{s.logInteraction(e.buttonRowFactory().removeButtonFactory().hitRemoveParticipant({participantId:n,sessionId:t}))}),[s,e])}}},37395:(e,s,n)=>{n.d(s,{f:()=>r});var t=n(68334),i=n(18308);const r=()=>(0,i.N)(t.t)},9043:(e,s,n)=>{n.d(s,{N:()=>r});var t=n(30758),i=n(37395);const r=(e,s)=>{const n=(0,i.f)();(0,t.useEffect)((()=>n.getEvents().addListener(e,s)),[e,n,s])}},33887:(e,s,n)=>{n.d(s,{Bj:()=>i,T4:()=>r,kt:()=>o});var t=n(72574);function i(e,s){if(!s)return null;const n=(0,t.o_h)(s);if(!n||!(0,t.APS)(n))return null;const i=(0,t.XIp)(n.username);return e.find((e=>e.username===i))??null}function r(e){const s=e.getCurrentSession(),n=s?.sessionOwnerId;return n?s.sessionMembers.find((e=>e.id===n))??null:null}function o(e,s){if(!s||!function(e){return e.getCurrentSession()?.isSessionOwner??!1}(e))return!1;const n=e.getCurrentSession(),t=i(n?.sessionMembers??[],s),o=r(e);return!!t&&t?.username!==o?.username}}}]);
//# sourceMappingURL=dwp-participant-list-page.js.map